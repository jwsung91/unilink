<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>unilink: Troubleshooting Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">unilink
   &#160;<span id="projectnumber">0.4.0</span>
   </div>
   <div id="projectbrief">A simple C++ library for unified async communication</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_docs_guides_core_troubleshooting.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Troubleshooting Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Common issues and solutions when using unilink.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md435"></a>
Table of Contents</h1>
<ol type="1">
<li><a href="#connection-issues">Connection Issues</a></li>
<li><a href="#compilation-errors">Compilation Errors</a></li>
<li><a href="#runtime-errors">Runtime Errors</a></li>
<li><a href="#performance-issues">Performance Issues</a></li>
<li><a href="#memory-issues">Memory Issues</a></li>
<li><a href="#thread-safety-issues">Thread Safety Issues</a></li>
<li><a href="#debugging-tips">Debugging Tips</a></li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md437"></a>
Connection Issues</h1>
<h2><a class="anchor" id="autotoc_md438"></a>
Problem: Connection Refused</h2>
<p><b>Symptoms:</b> </p><div class="fragment"><div class="line">✗ Error: Connection refused</div>
</div><!-- fragment --><p><b>Possible Causes &amp; Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md439"></a>
1. Server Not Running</h3>
<div class="fragment"><div class="line"># Check if server is running</div>
<div class="line">netstat -an | grep 8080</div>
<div class="line"># or</div>
<div class="line">lsof -i :8080</div>
</div><!-- fragment --><p><b>Solution:</b> Start the server before connecting client.</p>
<h3><a class="anchor" id="autotoc_md440"></a>
2. Wrong Host/Port</h3>
<div class="fragment"><div class="line"><span class="comment">// Check your configuration</span></div>
<div class="line"><span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, 8080)  <span class="comment">// Correct port?</span></div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">build</a>();</div>
<div class="ttc" id="aclassunilink_1_1builder_1_1TcpClientBuilder_html_a5a4af5b627ffc15c727cba9fa2fa1d93"><div class="ttname"><a href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">unilink::builder::TcpClientBuilder::build</a></div><div class="ttdeci">std::unique_ptr&lt; wrapper::TcpClient &gt; build() override</div><div class="ttdoc">Build and return the configured TcpClient.</div><div class="ttdef"><b>Definition:</b> <a href="tcp__client__builder_8cc_source.html#l00046">tcp_client_builder.cc:46</a></div></div>
<div class="ttc" id="anamespaceunilink_html_a6e965071daa5a68d914844bfbf79daac"><div class="ttname"><a href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">unilink::tcp_client</a></div><div class="ttdeci">builder::TcpClientBuilder tcp_client(const std::string &amp;host, uint16_t port)</div><div class="ttdoc">Create a TCP client builder.</div><div class="ttdef"><b>Definition:</b> <a href="unilink_8hpp_source.html#l00095">unilink.hpp:95</a></div></div>
</div><!-- fragment --><p><b>Solution:</b> Verify server address and port number.</p>
<h3><a class="anchor" id="autotoc_md441"></a>
3. Firewall Blocking</h3>
<div class="fragment"><div class="line"># Check firewall rules (Linux)</div>
<div class="line">sudo iptables -L | grep 8080</div>
<div class="line"> </div>
<div class="line"># Allow port (Ubuntu)</div>
<div class="line">sudo ufw allow 8080</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md443"></a>
Problem: Connection Timeout</h2>
<p><b>Symptoms:</b> </p><div class="fragment"><div class="line">✗ Error: Connection timeout</div>
</div><!-- fragment --><p><b>Possible Causes &amp; Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md444"></a>
1. Network Unreachable</h3>
<div class="fragment"><div class="line"># Test connectivity</div>
<div class="line">ping server.com</div>
<div class="line">telnet server.com 8080</div>
</div><!-- fragment --><p><b>Solution:</b> Check network connectivity, DNS resolution.</p>
<h3><a class="anchor" id="autotoc_md445"></a>
2. Server Overloaded</h3>
<p><b>Solution:</b> Increase retry interval: </p><div class="fragment"><div class="line"><span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;server.com&quot;</span>, 8080)</div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a61c44f9311cd798efac3449fdd2034d5">retry_interval</a>(10000)  <span class="comment">// Wait 10 seconds</span></div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">build</a>();</div>
<div class="ttc" id="aclassunilink_1_1builder_1_1TcpClientBuilder_html_a61c44f9311cd798efac3449fdd2034d5"><div class="ttname"><a href="classunilink_1_1builder_1_1TcpClientBuilder.html#a61c44f9311cd798efac3449fdd2034d5">unilink::builder::TcpClientBuilder::retry_interval</a></div><div class="ttdeci">TcpClientBuilder &amp; retry_interval(unsigned interval_ms)</div><div class="ttdoc">Set retry interval for automatic reconnection.</div><div class="ttdef"><b>Definition:</b> <a href="tcp__client__builder_8cc_source.html#l00155">tcp_client_builder.cc:155</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md446"></a>
3. Slow Network</h3>
<p><b>Solution:</b> Increase timeout (requires custom implementation): </p><div class="fragment"><div class="line"><span class="comment">// Set socket options for longer timeout</span></div>
<div class="line">boost::asio::socket_base::linger option(<span class="keyword">true</span>, 30);</div>
<div class="line">socket.set_option(option);</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md448"></a>
Problem: Connection Drops Randomly</h2>
<p><b>Symptoms:</b></p><ul>
<li>Client disconnects unexpectedly</li>
<li><code>on_disconnect()</code> called without <code>stop()</code></li>
</ul>
<p><b>Possible Causes &amp; Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md449"></a>
1. Network Instability</h3>
<div class="fragment"><div class="line"><span class="comment">// Enable auto-reconnection</span></div>
<div class="line"><span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;server.com&quot;</span>, 8080)</div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a61c44f9311cd798efac3449fdd2034d5">retry_interval</a>(3000)  <span class="comment">// Retry every 3 seconds</span></div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a218af94b28e588485b61be951ab8f6f6">on_disconnect</a>([]() {</div>
<div class="line">        log_info(<span class="stringliteral">&quot;Disconnected, will auto-retry&quot;</span>);</div>
<div class="line">    })</div>
<div class="line">    .build();</div>
<div class="ttc" id="aclassunilink_1_1builder_1_1TcpClientBuilder_html_a218af94b28e588485b61be951ab8f6f6"><div class="ttname"><a href="classunilink_1_1builder_1_1TcpClientBuilder.html#a218af94b28e588485b61be951ab8f6f6">unilink::builder::TcpClientBuilder::on_disconnect</a></div><div class="ttdeci">TcpClientBuilder &amp; on_disconnect(std::function&lt; void()&gt; handler) override</div><div class="ttdoc">Set disconnection handler callback.</div><div class="ttdef"><b>Definition:</b> <a href="tcp__client__builder_8cc_source.html#l00140">tcp_client_builder.cc:140</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md450"></a>
2. Server Closing Connection</h3>
<div class="fragment"><div class="line"><span class="comment">// Log disconnect reason</span></div>
<div class="line">.on_disconnect([<span class="keyword">this</span>]() {</div>
<div class="line">    <span class="comment">// Check if stop() was called</span></div>
<div class="line">    <span class="keywordflow">if</span> (!intentional_disconnect_) {</div>
<div class="line">        log_warning(<span class="stringliteral">&quot;Unexpected disconnect from server&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">})</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md451"></a>
3. Keep-Alive Not Set</h3>
<div class="fragment"><div class="line"><span class="comment">// Implement heartbeat</span></div>
<div class="line">std::thread heartbeat_thread([<span class="keyword">this</span>]() {</div>
<div class="line">    <span class="keywordflow">while</span> (running_) {</div>
<div class="line">        <span class="keywordflow">if</span> (client_-&gt;is_connected()) {</div>
<div class="line">            client_-&gt;send(<span class="stringliteral">&quot;PING\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        std::this_thread::sleep_for(std::chrono::seconds(30));</div>
<div class="line">    }</div>
<div class="line">});</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md453"></a>
Problem: Port Already in Use</h2>
<p><b>Symptoms:</b> </p><div class="fragment"><div class="line">✗ Error: Address already in use</div>
</div><!-- fragment --><p><b>Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md454"></a>
1. Kill Existing Process</h3>
<div class="fragment"><div class="line"># Find process using port</div>
<div class="line">lsof -i :8080</div>
<div class="line"># or</div>
<div class="line">netstat -tulpn | grep 8080</div>
<div class="line"> </div>
<div class="line"># Kill process</div>
<div class="line">kill -9 &lt;PID&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md455"></a>
2. Use Different Port</h3>
<div class="fragment"><div class="line"><span class="keyword">auto</span> server = <a class="code" href="namespaceunilink.html#a14c0a21a3c09f578b71455e31cf47956">tcp_server</a>(8081)  <span class="comment">// Try different port</span></div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpServerBuilder.html#a9c74b1d7730ee134044b4fcc111191ec">build</a>();</div>
<div class="ttc" id="aclassunilink_1_1builder_1_1TcpServerBuilder_html_a9c74b1d7730ee134044b4fcc111191ec"><div class="ttname"><a href="classunilink_1_1builder_1_1TcpServerBuilder.html#a9c74b1d7730ee134044b4fcc111191ec">unilink::builder::TcpServerBuilder::build</a></div><div class="ttdeci">std::unique_ptr&lt; wrapper::TcpServer &gt; build() override</div><div class="ttdoc">Build and return the configured TcpServer.</div><div class="ttdef"><b>Definition:</b> <a href="tcp__server__builder_8cc_source.html#l00048">tcp_server_builder.cc:48</a></div></div>
<div class="ttc" id="anamespaceunilink_html_a14c0a21a3c09f578b71455e31cf47956"><div class="ttname"><a href="namespaceunilink.html#a14c0a21a3c09f578b71455e31cf47956">unilink::tcp_server</a></div><div class="ttdeci">builder::TcpServerBuilder tcp_server(uint16_t port)</div><div class="ttdoc">Create a TCP server builder.</div><div class="ttdef"><b>Definition:</b> <a href="unilink_8hpp_source.html#l00087">unilink.hpp:87</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md456"></a>
3. Enable Port Retry</h3>
<div class="fragment"><div class="line"><span class="keyword">auto</span> server = <a class="code" href="namespaceunilink.html#a14c0a21a3c09f578b71455e31cf47956">tcp_server</a>(8080)</div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpServerBuilder.html#a5361cef3aa804d32cba0b73c02e6492d">enable_port_retry</a>(<span class="keyword">true</span>, 5, 1000)  <span class="comment">// Retry 5 times</span></div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpServerBuilder.html#a9c74b1d7730ee134044b4fcc111191ec">build</a>();</div>
<div class="ttc" id="aclassunilink_1_1builder_1_1TcpServerBuilder_html_a5361cef3aa804d32cba0b73c02e6492d"><div class="ttname"><a href="classunilink_1_1builder_1_1TcpServerBuilder.html#a5361cef3aa804d32cba0b73c02e6492d">unilink::builder::TcpServerBuilder::enable_port_retry</a></div><div class="ttdeci">TcpServerBuilder &amp; enable_port_retry(bool enable=true, int max_retries=3, int retry_interval_ms=1000)</div><div class="ttdoc">Enable port binding retry on failure.</div><div class="ttdef"><b>Definition:</b> <a href="tcp__server__builder_8cc_source.html#l00211">tcp_server_builder.cc:211</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md457"></a>
4. Set SO_REUSEADDR (Advanced)</h3>
<div class="fragment"><div class="line"><span class="comment">// Allow immediate port reuse</span></div>
<div class="line">boost::asio::socket_base::reuse_address option(<span class="keyword">true</span>);</div>
<div class="line">acceptor.set_option(option);</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md459"></a>
Compilation Errors</h1>
<h2><a class="anchor" id="autotoc_md460"></a>
Problem: unilink/unilink.hpp Not Found</h2>
<p><b>Symptoms:</b> </p><div class="fragment"><div class="line">fatal error: unilink/unilink.hpp: No such file or directory</div>
</div><!-- fragment --><p><b>Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md461"></a>
1. Install unilink</h3>
<div class="fragment"><div class="line">cd interface-socket</div>
<div class="line">cmake -S . -B build</div>
<div class="line">sudo cmake --install build</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md462"></a>
2. Add Include Path</h3>
<div class="fragment"><div class="line"># CMake</div>
<div class="line">target_include_directories(your_app PRIVATE /path/to/unilink/include)</div>
<div class="line"> </div>
<div class="line"># g++</div>
<div class="line">g++ -I/path/to/unilink/include ...</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md463"></a>
3. Use as Subdirectory</h3>
<div class="fragment"><div class="line"># CMakeLists.txt</div>
<div class="line">add_subdirectory(unilink)</div>
<div class="line">target_link_libraries(your_app PRIVATE unilink)</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md465"></a>
Problem: Undefined Reference to unilink Symbols</h2>
<p><b>Symptoms:</b> </p><div class="fragment"><div class="line">undefined reference to `unilink::tcp_client(std::string const&amp;, unsigned short)&#39;</div>
</div><!-- fragment --><p><b>Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md466"></a>
1. Link unilink Library</h3>
<div class="fragment"><div class="line"># g++</div>
<div class="line">g++ main.cpp -o app -lunilink -lboost_system -pthread</div>
<div class="line"> </div>
<div class="line"># CMake</div>
<div class="line">target_link_libraries(your_app PRIVATE unilink Boost::system pthread)</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md467"></a>
2. Check Library Path</h3>
<div class="fragment"><div class="line"># Add to LD_LIBRARY_PATH</div>
<div class="line">export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH</div>
<div class="line"> </div>
<div class="line"># Or add to ldconfig</div>
<div class="line">sudo sh -c &#39;echo &quot;/usr/local/lib&quot; &gt; /etc/ld.so.conf.d/unilink.conf&#39;</div>
<div class="line">sudo ldconfig</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md469"></a>
Problem: Boost Not Found</h2>
<p><b>Symptoms:</b> </p><div class="fragment"><div class="line">CMake Error: Could not find Boost</div>
</div><!-- fragment --><p><b>Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md470"></a>
Ubuntu/Debian</h3>
<div class="fragment"><div class="line">sudo apt install libboost-all-dev</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md471"></a>
macOS</h3>
<div class="fragment"><div class="line">brew install boost</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md472"></a>
Windows (vcpkg)</h3>
<div class="fragment"><div class="line">vcpkg install boost</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md473"></a>
Manual Boost Path</h3>
<div class="fragment"><div class="line">set(BOOST_ROOT /path/to/boost)</div>
<div class="line">find_package(Boost REQUIRED COMPONENTS system)</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md475"></a>
Runtime Errors</h1>
<h2><a class="anchor" id="autotoc_md476"></a>
Problem: Segmentation Fault</h2>
<p><b>Symptoms:</b> </p><div class="fragment"><div class="line">Segmentation fault (core dumped)</div>
</div><!-- fragment --><p><b>Debugging Steps:</b></p>
<h3><a class="anchor" id="autotoc_md477"></a>
1. Enable Core Dumps</h3>
<div class="fragment"><div class="line">ulimit -c unlimited</div>
<div class="line">./your_app</div>
<div class="line"># If crash occurs, core dump is created</div>
<div class="line"> </div>
<div class="line"># Analyze with gdb</div>
<div class="line">gdb ./your_app core</div>
<div class="line">(gdb) bt  # backtrace</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md478"></a>
2. Use AddressSanitizer</h3>
<div class="fragment"><div class="line"># Compile with sanitizer</div>
<div class="line">cmake -DUNILINK_ENABLE_SANITIZERS=ON ..</div>
<div class="line">cmake --build .</div>
<div class="line"> </div>
<div class="line"># Run</div>
<div class="line">./your_app</div>
<div class="line"># Will show detailed error if memory issue</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md479"></a>
3. Common Causes</h3>
<p><b>Dangling Pointer:</b> </p><div class="fragment"><div class="line"><span class="comment">// BAD</span></div>
<div class="line"><span class="keyword">auto</span>* client = client_ptr.get();</div>
<div class="line">client_ptr.reset();  <span class="comment">// Deletes object</span></div>
<div class="line">client-&gt;send(<span class="stringliteral">&quot;data&quot;</span>);  <span class="comment">// CRASH - dangling pointer</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD</span></div>
<div class="line"><span class="keyword">auto</span> client = client_ptr;  <span class="comment">// Keep shared_ptr alive</span></div>
<div class="line">client-&gt;send(<span class="stringliteral">&quot;data&quot;</span>);</div>
</div><!-- fragment --><p><b>Use After Stop:</b> </p><div class="fragment"><div class="line"><span class="comment">// BAD</span></div>
<div class="line">client-&gt;stop();</div>
<div class="line">client-&gt;send(<span class="stringliteral">&quot;data&quot;</span>);  <span class="comment">// CRASH - client stopped</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD</span></div>
<div class="line"><span class="keywordflow">if</span> (client-&gt;is_connected()) {</div>
<div class="line">    client-&gt;send(<span class="stringliteral">&quot;data&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md481"></a>
Problem: Callbacks Not Being Called</h2>
<p><b>Symptoms:</b></p><ul>
<li><code>on_connect()</code> never called</li>
<li><code>on_data()</code> not receiving data</li>
</ul>
<p><b>Possible Causes &amp; Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md482"></a>
1. Callback Not Registered</h3>
<div class="fragment"><div class="line"><span class="comment">// BAD - Forgot to register callback</span></div>
<div class="line"><span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;server.com&quot;</span>, 8080)</div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">build</a>();  <span class="comment">// No on_data callback!</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD</span></div>
<div class="line"><span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;server.com&quot;</span>, 8080)</div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#af0f78cdc2328bf0d06ef3789b3e4e41d">on_data</a>([](<span class="keyword">const</span> std::string&amp; data) {</div>
<div class="line">        std::cout &lt;&lt; data &lt;&lt; std::endl;</div>
<div class="line">    })</div>
<div class="line">    .build();</div>
<div class="ttc" id="aclassunilink_1_1builder_1_1TcpClientBuilder_html_af0f78cdc2328bf0d06ef3789b3e4e41d"><div class="ttname"><a href="classunilink_1_1builder_1_1TcpClientBuilder.html#af0f78cdc2328bf0d06ef3789b3e4e41d">unilink::builder::TcpClientBuilder::on_data</a></div><div class="ttdeci">TcpClientBuilder &amp; on_data(std::function&lt; void(const std::string &amp;)&gt; handler) override</div><div class="ttdoc">Set data handler callback.</div><div class="ttdef"><b>Definition:</b> <a href="tcp__client__builder_8cc_source.html#l00130">tcp_client_builder.cc:130</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md483"></a>
2. Client Not Started</h3>
<div class="fragment"><div class="line"><span class="comment">// BAD - Forgot to start</span></div>
<div class="line"><span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;server.com&quot;</span>, 8080)</div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">build</a>();</div>
<div class="line"><span class="comment">// ... client never starts!</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD - Always call start explicitly</span></div>
<div class="line"><span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;server.com&quot;</span>, 8080)</div>
<div class="line">    .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">build</a>();</div>
<div class="line">client-&gt;start();  <span class="comment">// Start the connection</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md484"></a>
3. Application Exits Too Quickly</h3>
<div class="fragment"><div class="line"><span class="comment">// BAD</span></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;server.com&quot;</span>, 8080)</div>
<div class="line">        .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a4ae0c7b5b6f6c02066844fcb5a71ad9a">on_connect</a>([]() { std::cout &lt;&lt; <span class="stringliteral">&quot;Connected!\n&quot;</span>; })</div>
<div class="line">        .build();</div>
<div class="line">    client-&gt;start();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;  <span class="comment">// Exits immediately before connection!</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD</span></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;server.com&quot;</span>, 8080)</div>
<div class="line">        .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a4ae0c7b5b6f6c02066844fcb5a71ad9a">on_connect</a>([]() { std::cout &lt;&lt; <span class="stringliteral">&quot;Connected!\n&quot;</span>; })</div>
<div class="line">        .build();</div>
<div class="line">    client-&gt;start();</div>
<div class="line">    </div>
<div class="line">    std::this_thread::sleep_for(std::chrono::seconds(10));  <span class="comment">// Wait</span></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassunilink_1_1builder_1_1TcpClientBuilder_html_a4ae0c7b5b6f6c02066844fcb5a71ad9a"><div class="ttname"><a href="classunilink_1_1builder_1_1TcpClientBuilder.html#a4ae0c7b5b6f6c02066844fcb5a71ad9a">unilink::builder::TcpClientBuilder::on_connect</a></div><div class="ttdeci">TcpClientBuilder &amp; on_connect(std::function&lt; void()&gt; handler) override</div><div class="ttdoc">Set connection handler callback.</div><div class="ttdef"><b>Definition:</b> <a href="tcp__client__builder_8cc_source.html#l00135">tcp_client_builder.cc:135</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md486"></a>
Performance Issues</h1>
<h2><a class="anchor" id="autotoc_md487"></a>
Problem: High CPU Usage</h2>
<p><b>Symptoms:</b></p><ul>
<li>Process using 100% CPU</li>
<li>System becomes slow</li>
</ul>
<p><b>Possible Causes &amp; Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md488"></a>
1. Busy Loop in Callback</h3>
<div class="fragment"><div class="line"><span class="comment">// BAD - Blocks I/O thread</span></div>
<div class="line">.on_data([](<span class="keyword">const</span> std::string&amp; data) {</div>
<div class="line">    <span class="keywordflow">while</span> (processing) {  <span class="comment">// Busy loop!</span></div>
<div class="line">        process();</div>
<div class="line">    }</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD - Process asynchronously</span></div>
<div class="line">.on_data([<span class="keyword">this</span>](<span class="keyword">const</span> std::string&amp; data) {</div>
<div class="line">    message_queue_.push(data);  <span class="comment">// Queue for processing</span></div>
<div class="line">})</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md489"></a>
2. Too Many Retries</h3>
<div class="fragment"><div class="line"><span class="comment">// BAD - Retries too often</span></div>
<div class="line">.retry_interval(10)  <span class="comment">// Retry every 10ms!</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD</span></div>
<div class="line">.retry_interval(3000)  <span class="comment">// Retry every 3 seconds</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md490"></a>
3. Excessive Logging</h3>
<div class="fragment"><div class="line"><span class="comment">// BAD - Log every byte</span></div>
<div class="line">.on_data([](<span class="keyword">const</span> std::string&amp; data) {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keywordtype">byte</span> : data) {</div>
<div class="line">        logger.debug(<span class="stringliteral">&quot;byte&quot;</span>, <span class="stringliteral">&quot;received&quot;</span>, std::to_string(<span class="keywordtype">byte</span>));</div>
<div class="line">    }</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD - Log summary</span></div>
<div class="line">.on_data([](<span class="keyword">const</span> std::string&amp; data) {</div>
<div class="line">    logger.debug(<span class="stringliteral">&quot;data&quot;</span>, <span class="stringliteral">&quot;received&quot;</span>, <span class="stringliteral">&quot;Received &quot;</span> + std::to_string(data.size()) + <span class="stringliteral">&quot; bytes&quot;</span>);</div>
<div class="line">})</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md492"></a>
Problem: High Memory Usage</h2>
<p><b>Symptoms:</b></p><ul>
<li>Memory usage keeps growing</li>
<li>Out of memory errors</li>
</ul>
<p><b>Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md493"></a>
1. Enable Memory Tracking (Debug)</h3>
<div class="fragment"><div class="line">cmake -DUNILINK_ENABLE_MEMORY_TRACKING=ON ..</div>
<div class="line">cmake --build .</div>
<div class="line">./your_app</div>
<div class="line"> </div>
<div class="line"># Check memory report</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md494"></a>
2. Fix Memory Leaks</h3>
<div class="fragment"><div class="line"><span class="comment">// BAD - Circular reference</span></div>
<div class="line"><span class="keyword">class </span>Client {</div>
<div class="line">    std::shared_ptr&lt;Handler&gt; handler_;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">class </span>Handler {</div>
<div class="line">    std::shared_ptr&lt;Client&gt; client_;  <span class="comment">// Circular!</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD - Break cycle with weak_ptr</span></div>
<div class="line"><span class="keyword">class </span>Handler {</div>
<div class="line">    std::weak_ptr&lt;Client&gt; client_;  <span class="comment">// Weak reference</span></div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md495"></a>
3. Limit Buffer Sizes</h3>
<div class="fragment"><div class="line"><span class="comment">// Limit message queue size</span></div>
<div class="line">std::deque&lt;std::string&gt; message_queue_;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span> MAX_QUEUE_SIZE = 1000;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> add_message(<span class="keyword">const</span> std::string&amp; msg) {</div>
<div class="line">    <span class="keywordflow">if</span> (message_queue_.size() &gt;= MAX_QUEUE_SIZE) {</div>
<div class="line">        message_queue_.pop_front();  <span class="comment">// Drop oldest</span></div>
<div class="line">    }</div>
<div class="line">    message_queue_.push_back(msg);</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md497"></a>
Problem: Slow Data Transfer</h2>
<p><b>Symptoms:</b></p><ul>
<li>Low throughput</li>
<li>Messages take long to arrive</li>
</ul>
<p><b>Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md498"></a>
1. Batch Small Messages</h3>
<div class="fragment"><div class="line"><span class="comment">// BAD - Send each character</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">char</span> c : message) {</div>
<div class="line">    client-&gt;send(std::string(1, c));  <span class="comment">// Slow!</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD - Send whole message</span></div>
<div class="line">client-&gt;send(message);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md499"></a>
2. Use Binary Protocol</h3>
<div class="fragment"><div class="line"><span class="comment">// Instead of text: &quot;LENGTH:1024\nDATA:...&quot;</span></div>
<div class="line"><span class="comment">// Use binary: [4 bytes length][data]</span></div>
<div class="line"> </div>
<div class="line">std::vector&lt;uint8_t&gt; create_binary_message(<span class="keyword">const</span> std::string&amp; data) {</div>
<div class="line">    std::vector&lt;uint8_t&gt; msg;</div>
<div class="line">    uint32_t len = data.size();</div>
<div class="line">    msg.insert(msg.end(), (uint8_t*)&amp;len, (uint8_t*)&amp;len + 4);</div>
<div class="line">    msg.insert(msg.end(), data.begin(), data.end());</div>
<div class="line">    <span class="keywordflow">return</span> msg;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md500"></a>
3. Enable Async Logging</h3>
<div class="fragment"><div class="line"><span class="comment">// Don&#39;t let logging slow down I/O</span></div>
<div class="line">Logger::instance().enable_async(<span class="keyword">true</span>);</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md502"></a>
Memory Issues</h1>
<h2><a class="anchor" id="autotoc_md503"></a>
Problem: Memory Leak Detected</h2>
<p><b>Symptoms:</b> </p><div class="fragment"><div class="line">Memory leak detected: 1024 bytes at 0x...</div>
</div><!-- fragment --><p><b>Debugging:</b></p>
<div class="fragment"><div class="line"># Build with AddressSanitizer</div>
<div class="line">cmake -DUNILINK_ENABLE_SANITIZERS=ON ..</div>
<div class="line">cmake --build .</div>
<div class="line"> </div>
<div class="line"># Run</div>
<div class="line">ASAN_OPTIONS=detect_leaks=1 ./your_app</div>
<div class="line"> </div>
<div class="line"># Or use valgrind</div>
<div class="line">valgrind --leak-check=full ./your_app</div>
</div><!-- fragment --><p><b>Common Causes:</b></p>
<div class="fragment"><div class="line"><span class="comment">// 1. Not calling stop()</span></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">tcp_client</a>(<span class="stringliteral">&quot;server.com&quot;</span>, 8080).<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">build</a>();</div>
<div class="line">    client-&gt;start();</div>
<div class="line">    <span class="comment">// Forgot to call client-&gt;stop()</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 2. Circular shared_ptr</span></div>
<div class="line"><span class="comment">// See &quot;High Memory Usage&quot; section above</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// 3. Not clearing callbacks</span></div>
<div class="line">server-&gt;clear_callbacks();  <span class="comment">// Clear before destruction</span></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md505"></a>
Thread Safety Issues</h1>
<h2><a class="anchor" id="autotoc_md506"></a>
Problem: Race Condition / Data Corruption</h2>
<p><b>Symptoms:</b></p><ul>
<li>Occasional crashes</li>
<li>Corrupted data</li>
<li>Inconsistent state</li>
</ul>
<p><b>Solutions:</b></p>
<h3><a class="anchor" id="autotoc_md507"></a>
1. Protect Shared State</h3>
<div class="fragment"><div class="line"><span class="comment">// BAD - No protection</span></div>
<div class="line">std::map&lt;size_t, ClientInfo&gt; clients_;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> add_client(<span class="keywordtype">size_t</span> <span class="keywordtype">id</span>) {</div>
<div class="line">    clients_[id] = ClientInfo{};  <span class="comment">// UNSAFE!</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// GOOD - Use mutex</span></div>
<div class="line">std::mutex clients_mutex_;</div>
<div class="line">std::map&lt;size_t, ClientInfo&gt; clients_;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> add_client(<span class="keywordtype">size_t</span> <span class="keywordtype">id</span>) {</div>
<div class="line">    std::lock_guard&lt;std::mutex&gt; lock(clients_mutex_);</div>
<div class="line">    clients_[id] = ClientInfo{};  <span class="comment">// Safe</span></div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md508"></a>
2. Use Thread-Safe Containers</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="thread__safe__state_8hpp.html">unilink/concurrency/thread_safe_state.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line">unilink::common::ThreadSafeState&lt;State&gt; state_;</div>
<div class="line"><span class="comment">// All operations are thread-safe</span></div>
<div class="ttc" id="athread__safe__state_8hpp_html"><div class="ttname"><a href="thread__safe__state_8hpp.html">thread_safe_state.hpp</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md510"></a>
Debugging Tips</h1>
<h2><a class="anchor" id="autotoc_md511"></a>
Enable Debug Logging</h2>
<div class="fragment"><div class="line"><span class="comment">// In main() or initialization</span></div>
<div class="line"><span class="keywordtype">void</span> setup_debugging() {</div>
<div class="line">    <span class="comment">// Set debug log level</span></div>
<div class="line">    unilink::common::Logger::instance().set_level(unilink::common::LogLevel::DEBUG);</div>
<div class="line">    unilink::common::Logger::instance().set_console_output(<span class="keyword">true</span>);</div>
<div class="line">    unilink::common::Logger::instance().set_file_output(<span class="stringliteral">&quot;debug.log&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Enable error handler</span></div>
<div class="line">    unilink::common::ErrorHandler::instance().set_min_error_level(</div>
<div class="line">        unilink::common::ErrorLevel::INFO</div>
<div class="line">    );</div>
<div class="line">    unilink::common::ErrorHandler::instance().register_callback(</div>
<div class="line">        [](<span class="keyword">const</span> unilink::common::ErrorInfo&amp; error) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;[ERROR] &quot;</span> &lt;&lt; error.get_summary() &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    );</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md512"></a>
Use GDB for Debugging</h2>
<div class="fragment"><div class="line"># Compile with debug symbols</div>
<div class="line">cmake -DCMAKE_BUILD_TYPE=Debug ..</div>
<div class="line">cmake --build .</div>
<div class="line"> </div>
<div class="line"># Run with gdb</div>
<div class="line">gdb ./your_app</div>
<div class="line"> </div>
<div class="line"># Useful gdb commands</div>
<div class="line">(gdb) break main</div>
<div class="line">(gdb) run</div>
<div class="line">(gdb) next</div>
<div class="line">(gdb) step</div>
<div class="line">(gdb) print variable_name</div>
<div class="line">(gdb) bt  # backtrace</div>
<div class="line">(gdb) info threads</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md513"></a>
Network Debugging with tcpdump</h2>
<div class="fragment"><div class="line"># Capture traffic on port 8080</div>
<div class="line">sudo tcpdump -i any -nn port 8080 -A</div>
<div class="line"> </div>
<div class="line"># Save to file</div>
<div class="line">sudo tcpdump -i any port 8080 -w capture.pcap</div>
<div class="line"> </div>
<div class="line"># View with Wireshark</div>
<div class="line">wireshark capture.pcap</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md514"></a>
Test with netcat</h2>
<div class="fragment"><div class="line"># Server mode - listen on port 8080</div>
<div class="line">nc -l 8080</div>
<div class="line"> </div>
<div class="line"># Client mode - connect to server</div>
<div class="line">nc localhost 8080</div>
<div class="line"> </div>
<div class="line"># Send file</div>
<div class="line">nc localhost 8080 &lt; test_data.txt</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md516"></a>
Getting Help</h1>
<p>If you're still experiencing issues:</p>
<ol type="1">
<li><b>Check Examples</b>: Look at <code>examples/</code> directory</li>
<li><b>Read API Guide</b>: See <code>docs/reference/API_GUIDE.md</code></li>
<li><b>Search Issues</b>: <a href="https://github.com/jwsung91/unilink/issues">https://github.com/jwsung91/unilink/issues</a></li>
<li><b>Ask Community</b>: Create a new issue with:<ul>
<li>Minimal reproducible example</li>
<li>Error messages / logs</li>
<li>Environment details (OS, compiler, versions)</li>
<li>What you've tried so far</li>
</ul>
</li>
</ol>
<hr  />
<p><b>See Also:</b></p><ul>
<li><a class="el" href="md_docs_guides_core_best_practices.html">Best Practices</a></li>
<li>Performance Tuning</li>
<li>../reference/API_GUIDE.md "API Reference" </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Feb 16 2026 02:53:20 for unilink by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
