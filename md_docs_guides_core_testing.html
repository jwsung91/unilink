<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>unilink: Testing Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">unilink
   &#160;<span id="projectnumber">0.3.3</span>
   </div>
   <div id="projectbrief">A simple C++ library for unified async communication</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_docs_guides_core_testing.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Testing Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Complete guide for testing <code>unilink</code>, including running tests, CI/CD integration, and writing custom tests.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md355"></a>
Table of Contents</h1>
<ol type="1">
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#running-tests">Running Tests</a></li>
<li><a href="#test-categories">Test Categories</a></li>
<li><a href="#memory-safety-validation">Memory Safety Validation</a></li>
<li><a href="#continuous-integration">Continuous Integration</a></li>
<li><a href="#writing-custom-tests">Writing Custom Tests</a></li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md357"></a>
Quick Start</h1>
<h2><a class="anchor" id="autotoc_md358"></a>
Build and Run All Tests</h2>
<div class="fragment"><div class="line"># 1. Build with tests enabled</div>
<div class="line">cmake -S . -B build -DCMAKE_BUILD_TYPE=Debug -DUNILINK_BUILD_TESTS=ON</div>
<div class="line">cmake --build build -j</div>
<div class="line"> </div>
<div class="line"># 2. Run all tests</div>
<div class="line">cd build</div>
<div class="line">ctest --output-on-failure</div>
<div class="line"> </div>
<div class="line"># 3. View results</div>
<div class="line"># All tests should pass with detailed output</div>
</div><!-- fragment --><p><b>Suite toggles</b></p><ul>
<li>Master switch: <code>-DUNILINK_BUILD_TESTS=ON|OFF</code></li>
<li>Performance-only toggle: <code>UNILINK_ENABLE_PERFORMANCE_TESTS</code></li>
<li>Packaging tip: set <code>UNILINK_BUILD_TESTS=OFF</code> (and perf OFF) in vcpkg/air-gapped builds to skip fetching GoogleTest.</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md360"></a>
Windows Build &amp; Test Workflow</h2>
<div class="fragment"><div class="line"># 1. Configure with Visual Studio generator</div>
<div class="line">cmake -S . -B build-windows `</div>
<div class="line">  -G &quot;Visual Studio 17 2022&quot; -A x64 `</div>
<div class="line">  -DUNILINK_BUILD_TESTS=ON</div>
<div class="line"> </div>
<div class="line"># 2. Build the desired configuration (Debug shown here)</div>
<div class="line">cmake --build build-windows --config Debug --target ALL_BUILD</div>
<div class="line"> </div>
<div class="line"># 3. Execute the test suite</div>
<div class="line">ctest --test-dir build-windows -C Debug --output-on-failure</div>
</div><!-- fragment --><p>Or, using Ninja with a vcpkg toolchain:</p>
<div class="fragment"><div class="line">Remove-Item build-windows -Recurse -Force</div>
<div class="line">cmake -S . -B build-windows -G &quot;Ninja&quot; `</div>
<div class="line">  -DCMAKE_TOOLCHAIN_FILE=&quot;F:/lib/vcpkg/scripts/buildsystems/vcpkg.cmake&quot; `</div>
<div class="line">  -DVCPKG_TARGET_TRIPLET=x64-windows `</div>
<div class="line">  -DUNILINK_BUILD_SHARED=ON `</div>
<div class="line">  -DUNILINK_BUILD_TESTS=ON</div>
<div class="line">cmake --build build-windows</div>
<div class="line">ctest --test-dir build-windows --output-on-failure</div>
</div><!-- fragment --><p><b>Windows-specific notes</b></p><ul>
<li>Re-run CMake (or create a fresh <code>build-windows</code> directory) after updating the repository so that example binaries inherit the post-build step that copies <code>unilink.dll</code> beside each executable.</li>
<li>Serial error recovery scenarios rely on Unix-style device paths and are automatically skipped when running on Windows.</li>
<li>The async logging performance benchmark expects ≥50k messages/sec on Windows (versus 100k+ on Linux) because of OS timer granularity and scheduling differences.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md362"></a>
Running Tests</h1>
<h2><a class="anchor" id="autotoc_md363"></a>
Run All Tests</h2>
<div class="fragment"><div class="line">cd build</div>
<div class="line">ctest --output-on-failure</div>
</div><!-- fragment --><p><b>Expected output:</b> </p><div class="fragment"><div class="line">Test project /path/to/unilink/build</div>
<div class="line">    Start 1: BaseTest.CommonFunctionality</div>
<div class="line">1/X Test #1: BaseTest.CommonFunctionality ................   Passed    0.XX sec</div>
<div class="line">    ...</div>
<div class="line">100% tests passed, 0 tests failed out of X</div>
<div class="line"> </div>
<div class="line">Total Test time (real) = XX.XX sec</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md365"></a>
Run Specific Test Categories</h2>
<p>Individual test executables are available:</p>
<div class="fragment"><div class="line"># Core functionality tests</div>
<div class="line">./build/test/run_core_tests</div>
<div class="line"> </div>
<div class="line"># Integration tests (end-to-end)</div>
<div class="line">./build/test/run_integration_tests</div>
<div class="line"> </div>
<div class="line"># Memory safety tests</div>
<div class="line">./build/test/run_memory_safety_tests</div>
<div class="line"> </div>
<div class="line"># Thread safety and concurrency tests</div>
<div class="line">./build/test/run_concurrency_safety_tests</div>
<div class="line"> </div>
<div class="line"># Performance benchmarks</div>
<div class="line">./build/test/run_performance_tests</div>
<div class="line"> </div>
<div class="line"># Stress and stability tests</div>
<div class="line">./build/test/run_stress_tests</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md367"></a>
Run Tests with Verbose Output</h2>
<div class="fragment"><div class="line"># CTest verbose mode</div>
<div class="line">ctest --output-on-failure --verbose</div>
<div class="line"> </div>
<div class="line"># Run specific test with GTest output</div>
<div class="line">./build/test/run_core_tests --gtest_filter=TcpClientTest.*</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md369"></a>
Run Tests in Parallel</h2>
<div class="fragment"><div class="line"># Run tests in parallel (faster)</div>
<div class="line">ctest -j $(nproc)</div>
<div class="line"> </div>
<div class="line"># Limit parallel jobs</div>
<div class="line">ctest -j 4</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md371"></a>
UDP-specific test policies</h1>
<ul>
<li><b>Truncation handling</b>: UDP receive treats <code>boost::asio::error::message_size</code> or <code>bytes &gt;= rx_buffer_size</code> as truncation and fails fast into <code>Error</code> (no silent truncation, no re-armed receive loop).</li>
<li><b>Port allocation</b>: UDP tests use ephemeral ports (bind to port 0) helpers to minimize collisions; note this reduces but does not fully eliminate TOCTOU risk when rebinding.</li>
<li><b>Wait-until patterns</b>: Tests wait for conditions (peer learned, state change) with timeouts instead of fixed sleeps to reduce CI flakiness.</li>
<li><b>Stop semantics</b>: After <code>stop()</code>, user-level callbacks must not fire; cancellation stays internal (no user bytes callbacks after stop).</li>
</ul>
<h1><a class="anchor" id="autotoc_md372"></a>
Test Categories</h1>
<h2><a class="anchor" id="autotoc_md373"></a>
Core Tests</h2>
<p>Basic functionality and API tests.</p>
<div class="fragment"><div class="line">./build/test/run_core_tests</div>
</div><!-- fragment --><p><b>Tests:</b></p><ul>
<li>Builder API functionality</li>
<li>TCP client/server basic operations</li>
<li>Serial port configuration</li>
<li>Error handling</li>
<li>State management</li>
</ul>
<p><b>Coverage:</b> Fundamental library features</p>
<hr  />
<h2><a class="anchor" id="autotoc_md375"></a>
Integration Tests</h2>
<p>End-to-end communication tests with real networking.</p>
<div class="fragment"><div class="line">./build/test/run_integration_tests</div>
</div><!-- fragment --><p><b>Tests:</b></p><ul>
<li>TCP client-server communication</li>
<li>Serial loopback tests</li>
<li>Multi-client scenarios</li>
<li>Connection lifecycle</li>
<li>Data transfer validation</li>
</ul>
<p><b>Coverage:</b> Real-world usage scenarios</p>
<hr  />
<h2><a class="anchor" id="autotoc_md377"></a>
Memory Safety Tests</h2>
<p>Memory tracking, leak detection, and bounds checking.</p>
<div class="fragment"><div class="line">./build/test/run_memory_safety_tests</div>
</div><!-- fragment --><p><b>Tests:</b></p><ul>
<li>Memory leak detection</li>
<li>Buffer bounds checking</li>
<li>Safe data conversions</li>
<li>Memory pool validation</li>
<li>Allocation tracking</li>
</ul>
<p><b>Example output:</b> </p><div class="fragment"><div class="line">[==========] Running 10 tests from 1 test suite.</div>
<div class="line">[----------] 10 tests from MemorySafetyTest</div>
<div class="line">[ RUN      ] MemorySafetyTest.MemoryTrackingBasicFunctionality</div>
<div class="line">[       OK ] MemorySafetyTest.MemoryTrackingBasicFunctionality (0 ms)</div>
<div class="line">[ RUN      ] MemorySafetyTest.MemoryLeakDetection</div>
<div class="line">[       OK ] MemorySafetyTest.MemoryLeakDetection (0 ms)</div>
<div class="line">...</div>
<div class="line">[----------] 10 tests from MemorySafetyTest (1 ms total)</div>
<div class="line">[  PASSED  ] 10 tests.</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md379"></a>
Concurrency Safety Tests</h2>
<p>Thread safety and concurrent access patterns.</p>
<div class="fragment"><div class="line">./build/test/run_concurrency_safety_tests</div>
</div><!-- fragment --><p><b>Tests:</b></p><ul>
<li>Concurrent send operations</li>
<li>Thread-safe state management</li>
<li>Multiple threads calling APIs</li>
<li>Race condition detection</li>
<li>Lock contention scenarios</li>
</ul>
<p><b>Coverage:</b> Multi-threaded safety</p>
<hr  />
<p><b>TCP server regressions (stable IDs &amp; safe stop)</b></p>
<ul>
<li>Verifies that TCP server client IDs never get reused and that <code>stop()</code> is safe when called from callbacks.</li>
<li>Run the focused checks: <div class="fragment"><div class="line">./build/bin/run_unit_test_tcp_server_advanced \</div>
<div class="line">  --gtest_filter=AdvancedTcpServerCoverageTest.StableClientIdsAreMonotonicAndNotReused:AdvancedTcpServerCoverageTest.StopFromCallbackDoesNotDeadlock</div>
</div><!-- fragment --></li>
<li>Requires permission to bind local TCP ports; allow local sockets if your environment sandboxes networking.</li>
<li>TCP server multi-client send APIs return a bool (true on success, false if no target). Enable <code>notify_send_failure(true)</code> to trigger <code>on_error</code> when the target is missing or disconnected.</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md382"></a>
Performance Tests</h2>
<p>Performance benchmarks and optimization validation.</p>
<div class="fragment"><div class="line">./build/test/run_performance_tests</div>
</div><!-- fragment --><p><b>Tests:</b></p><ul>
<li>TCP throughput measurement</li>
<li>Latency benchmarks</li>
<li>Memory allocation overhead</li>
<li>Connection establishment time</li>
<li>Concurrent connection handling</li>
</ul>
<p><b>Example output:</b> </p><div class="fragment"><div class="line">TCP Throughput: 950 Mb/s</div>
<div class="line">TCP Latency (avg): 120 μs</div>
<div class="line">Memory Pool Hit Rate: 98.5%</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md384"></a>
Stress Tests</h2>
<p>High-load and stability testing.</p>
<div class="fragment"><div class="line">./build/test/run_stress_tests</div>
</div><!-- fragment --><p><b>Tests:</b></p><ul>
<li>Long-running connections (24+ hours)</li>
<li>High connection rate</li>
<li>Large data transfers</li>
<li>Memory stress</li>
<li>Connection churn</li>
</ul>
<p><b>Coverage:</b> Stability and reliability</p>
<hr  />
<h1><a class="anchor" id="autotoc_md386"></a>
Memory Safety Validation</h1>
<h2><a class="anchor" id="autotoc_md387"></a>
Built-in Memory Tracking</h2>
<p>Enable memory tracking for development:</p>
<div class="fragment"><div class="line">cmake -S . -B build \</div>
<div class="line">  -DCMAKE_BUILD_TYPE=Debug \</div>
<div class="line">  -DUNILINK_ENABLE_MEMORY_TRACKING=ON \</div>
<div class="line">  -DUNILINK_BUILD_TESTS=ON</div>
<div class="line"> </div>
<div class="line">cmake --build build -j</div>
<div class="line">cd build &amp;&amp; ctest</div>
</div><!-- fragment --><p><b>Features:</b></p><ul>
<li>Tracks all allocations and deallocations</li>
<li>Detects memory leaks</li>
<li>Reports memory usage patterns</li>
<li>Zero overhead in Release builds</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md389"></a>
AddressSanitizer (ASan)</h2>
<p>Detect memory errors at runtime:</p>
<div class="fragment"><div class="line">cmake -S . -B build \</div>
<div class="line">  -DCMAKE_BUILD_TYPE=Debug \</div>
<div class="line">  -DUNILINK_ENABLE_SANITIZERS=ON \</div>
<div class="line">  -DUNILINK_BUILD_TESTS=ON</div>
<div class="line"> </div>
<div class="line">cmake --build build -j</div>
<div class="line">cd build &amp;&amp; ctest --output-on-failure</div>
</div><!-- fragment --><p><b>Detects:</b></p><ul>
<li>✅ Use-after-free</li>
<li>✅ Heap buffer overflow</li>
<li>✅ Stack buffer overflow</li>
<li>✅ Memory leaks</li>
<li>✅ Use-after-return</li>
</ul>
<p><b>Note:</b> Tests run slower (~2-3x) with sanitizers enabled.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md391"></a>
ThreadSanitizer (TSan)</h2>
<p>Detect thread race conditions:</p>
<div class="fragment"><div class="line">cmake -S . -B build \</div>
<div class="line">  -DCMAKE_BUILD_TYPE=Debug \</div>
<div class="line">  -DCMAKE_CXX_FLAGS=&quot;-fsanitize=thread&quot; \</div>
<div class="line">  -DUNILINK_BUILD_TESTS=ON</div>
<div class="line"> </div>
<div class="line">cmake --build build -j</div>
<div class="line">cd build &amp;&amp; ctest</div>
</div><!-- fragment --><p><b>Detects:</b></p><ul>
<li>Data races</li>
<li>Deadlocks</li>
<li>Thread leaks</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md393"></a>
Valgrind</h2>
<p>Advanced memory debugging:</p>
<div class="fragment"><div class="line"># Build with debug symbols</div>
<div class="line">cmake -S . -B build -DCMAKE_BUILD_TYPE=Debug -DUNILINK_BUILD_TESTS=ON</div>
<div class="line">cmake --build build -j</div>
<div class="line"> </div>
<div class="line"># Run tests under Valgrind</div>
<div class="line">cd build</div>
<div class="line">ctest -T memcheck</div>
<div class="line"> </div>
<div class="line"># Or run specific test</div>
<div class="line">valgrind --leak-check=full --show-leak-kinds=all \</div>
<div class="line">  ./test/run_memory_safety_tests</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md395"></a>
Continuous Integration</h1>
<h2><a class="anchor" id="autotoc_md396"></a>
GitHub Actions Integration</h2>
<p>All tests are automatically run on every commit and pull request through GitHub Actions.</p>
<p><b>CI/CD Badges:</b></p>
<p><a href="https://github.com/jwsung91/unilink/actions/workflows/ci.yml"><img src="https://github.com/jwsung91/unilink/actions/workflows/ci.yml/badge.svg" alt="CI/CD Pipeline" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/jwsung91/unilink/actions/workflows/coverage.yml"><img src="https://github.com/jwsung91/unilink/actions/workflows/coverage.yml/badge.svg" alt="Code Coverage" style="pointer-events: none;" class="inline"/></a></p>
<hr  />
<h2><a class="anchor" id="autotoc_md398"></a>
CI/CD Build Matrix</h2>
<p>Tests run across multiple configurations:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Platform   </th><th class="markdownTableHeadNone">Compiler   </th><th class="markdownTableHeadNone">Build Type   </th><th class="markdownTableHeadNone">Sanitizers   </th><th class="markdownTableHeadNone">Test Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Ubuntu 22.04   </td><td class="markdownTableBodyNone">GCC 11   </td><td class="markdownTableBodyNone">Debug   </td><td class="markdownTableBodyNone">✅   </td><td class="markdownTableBodyNone">✅ Full Testing    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Ubuntu 22.04   </td><td class="markdownTableBodyNone">GCC 11   </td><td class="markdownTableBodyNone">Release   </td><td class="markdownTableBodyNone">❌   </td><td class="markdownTableBodyNone">✅ Full Testing    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Ubuntu 22.04   </td><td class="markdownTableBodyNone">Clang 14   </td><td class="markdownTableBodyNone">Debug   </td><td class="markdownTableBodyNone">✅   </td><td class="markdownTableBodyNone">✅ Full Testing    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Ubuntu 22.04   </td><td class="markdownTableBodyNone">Clang 14   </td><td class="markdownTableBodyNone">Release   </td><td class="markdownTableBodyNone">❌   </td><td class="markdownTableBodyNone">✅ Full Testing    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Ubuntu 24.04   </td><td class="markdownTableBodyNone">GCC 13   </td><td class="markdownTableBodyNone">Debug   </td><td class="markdownTableBodyNone">✅   </td><td class="markdownTableBodyNone">✅ Full Testing    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Ubuntu 24.04   </td><td class="markdownTableBodyNone">GCC 13   </td><td class="markdownTableBodyNone">Release   </td><td class="markdownTableBodyNone">❌   </td><td class="markdownTableBodyNone">✅ Full Testing    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Ubuntu 24.04   </td><td class="markdownTableBodyNone">Clang 15   </td><td class="markdownTableBodyNone">Debug   </td><td class="markdownTableBodyNone">✅   </td><td class="markdownTableBodyNone">✅ Full Testing    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Ubuntu 24.04   </td><td class="markdownTableBodyNone">Clang 15   </td><td class="markdownTableBodyNone">Release   </td><td class="markdownTableBodyNone">❌   </td><td class="markdownTableBodyNone">✅ Full Testing   </td></tr>
</table>
<p><b>Additional checks:</b></p><ul>
<li>Memory tracking enabled</li>
<li>Code coverage analysis</li>
<li>Performance regression tests</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md400"></a>
Ubuntu 20.04 Support</h2>
<p><b>Local Development Only:</b></p><ul>
<li>Ubuntu 20.04 is <b>not</b> supported in CI/CD due to runner availability issues</li>
<li>Ubuntu 20.04 reaches end-of-life in April 2025</li>
<li>Full testing is performed on Ubuntu 22.04 and 24.04</li>
<li>You can still build and test locally on Ubuntu 20.04</li>
</ul>
<p><b>Why No CI/CD Support?</b></p><ul>
<li>GitHub Actions Ubuntu 20.04 runners are being phased out</li>
<li>Frequent pending/queued states cause CI/CD delays</li>
<li>Ubuntu 20.04 reaches end-of-life in April 2025</li>
<li>Focus resources on supported platforms</li>
</ul>
<p><b>Local Testing on Ubuntu 20.04:</b> </p><div class="fragment"><div class="line"># Build and test locally on Ubuntu 20.04</div>
<div class="line">cmake -S . -B build -DCMAKE_BUILD_TYPE=Debug -DUNILINK_BUILD_TESTS=ON</div>
<div class="line">cmake --build build -j</div>
<div class="line">cd build &amp;&amp; ctest --output-on-failure</div>
</div><!-- fragment --><p><b>Recommendation:</b></p><ul>
<li>Consider upgrading to Ubuntu 22.04+ for full CI/CD support</li>
<li>Ubuntu 22.04 is the recommended platform for production use</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md402"></a>
View CI/CD Results</h2>
<p><b>CI/CD Dashboard:</b></p><ul>
<li><a href="https://github.com/jwsung91/unilink/actions">GitHub Actions Workflows</a></li>
<li><a href="https://github.com/jwsung91/unilink/actions/workflows/coverage.yml">Coverage Reports</a></li>
</ul>
<p><b>What CI/CD validates:</b></p><ul>
<li>✅ All unit tests pass</li>
<li>✅ No memory leaks detected</li>
<li>✅ No sanitizer errors</li>
<li>✅ Code coverage maintained</li>
<li>✅ Performance benchmarks within limits</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md404"></a>
Writing Custom Tests</h1>
<h2><a class="anchor" id="autotoc_md405"></a>
Test Structure</h2>
<p>Tests use Google Test framework:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;gtest/gtest.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="unilink_8hpp.html">unilink/unilink.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Test fixture</span></div>
<div class="line"><span class="keyword">class </span>MyTest : <span class="keyword">public</span> ::testing::Test {</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> SetUp()<span class="keyword"> override </span>{</div>
<div class="line">        <span class="comment">// Setup code</span></div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> TearDown()<span class="keyword"> override </span>{</div>
<div class="line">        <span class="comment">// Cleanup code</span></div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Test case</span></div>
<div class="line">TEST_F(MyTest, BasicFunctionality) {</div>
<div class="line">    <span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">unilink::tcp_client</a>(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, 8080)</div>
<div class="line">        .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">build</a>();</div>
<div class="line">    </div>
<div class="line">    ASSERT_NE(client, <span class="keyword">nullptr</span>);</div>
<div class="line">    EXPECT_FALSE(client-&gt;is_connected());</div>
<div class="line">}</div>
<div class="ttc" id="aclassunilink_1_1builder_1_1TcpClientBuilder_html_a5a4af5b627ffc15c727cba9fa2fa1d93"><div class="ttname"><a href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">unilink::builder::TcpClientBuilder::build</a></div><div class="ttdeci">std::unique_ptr&lt; wrapper::TcpClient &gt; build() override</div><div class="ttdoc">Build and return the configured TcpClient.</div><div class="ttdef"><b>Definition:</b> <a href="tcp__client__builder_8cc_source.html#l00046">tcp_client_builder.cc:46</a></div></div>
<div class="ttc" id="anamespaceunilink_html_a6e965071daa5a68d914844bfbf79daac"><div class="ttname"><a href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">unilink::tcp_client</a></div><div class="ttdeci">builder::TcpClientBuilder tcp_client(const std::string &amp;host, uint16_t port)</div><div class="ttdoc">Create a TCP client builder.</div><div class="ttdef"><b>Definition:</b> <a href="unilink_8hpp_source.html#l00095">unilink.hpp:95</a></div></div>
<div class="ttc" id="aunilink_8hpp_html"><div class="ttname"><a href="unilink_8hpp.html">unilink.hpp</a></div></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md407"></a>
Example: Custom Integration Test</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;gtest/gtest.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="unilink_8hpp.html">unilink/unilink.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;thread&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"> </div>
<div class="line">TEST(CustomTest, ClientServerCommunication) {</div>
<div class="line">    std::string received_data;</div>
<div class="line">    <span class="keywordtype">bool</span> server_ready = <span class="keyword">false</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Create server</span></div>
<div class="line">    <span class="keyword">auto</span> server = <a class="code" href="namespaceunilink.html#a14c0a21a3c09f578b71455e31cf47956">unilink::tcp_server</a>(8080)</div>
<div class="line">        .<a class="code" href="classunilink_1_1builder_1_1TcpServerBuilder.html#a94c1f68d31130820c5c2bd20b906fba5">unlimited_clients</a>()</div>
<div class="line">        .on_accept([](<span class="keyword">const</span> std::string&amp; client_id) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Client connected: &quot;</span> &lt;&lt; client_id &lt;&lt; std::endl;</div>
<div class="line">        })</div>
<div class="line">        .on_data([&amp;received_data](<span class="keyword">const</span> std::string&amp; data) {</div>
<div class="line">            received_data = data;</div>
<div class="line">        })</div>
<div class="line">        .build();</div>
<div class="line">    </div>
<div class="line">    server-&gt;start();</div>
<div class="line">    server_ready = <span class="keyword">true</span>;</div>
<div class="line">    std::this_thread::sleep_for(std::chrono::milliseconds(100));</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Create client</span></div>
<div class="line">    <span class="keyword">auto</span> client = <a class="code" href="namespaceunilink.html#a6e965071daa5a68d914844bfbf79daac">unilink::tcp_client</a>(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, 8080)</div>
<div class="line">        .<a class="code" href="classunilink_1_1builder_1_1TcpClientBuilder.html#a5a4af5b627ffc15c727cba9fa2fa1d93">build</a>();</div>
<div class="line">    </div>
<div class="line">    client-&gt;start();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Wait for connection</span></div>
<div class="line">    std::this_thread::sleep_for(std::chrono::milliseconds(100));</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Send data</span></div>
<div class="line">    std::string test_data = <span class="stringliteral">&quot;Hello, Server!&quot;</span>;</div>
<div class="line">    client-&gt;send(test_data);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Wait for data to be received</span></div>
<div class="line">    std::this_thread::sleep_for(std::chrono::milliseconds(100));</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Verify</span></div>
<div class="line">    EXPECT_EQ(received_data, test_data);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Cleanup</span></div>
<div class="line">    client-&gt;stop();</div>
<div class="line">    server-&gt;stop();</div>
<div class="line">}</div>
<div class="ttc" id="aclassunilink_1_1builder_1_1TcpServerBuilder_html_a94c1f68d31130820c5c2bd20b906fba5"><div class="ttname"><a href="classunilink_1_1builder_1_1TcpServerBuilder.html#a94c1f68d31130820c5c2bd20b906fba5">unilink::builder::TcpServerBuilder::unlimited_clients</a></div><div class="ttdeci">TcpServerBuilder &amp; unlimited_clients()</div><div class="ttdoc">Configure server for unlimited multi-client mode.</div><div class="ttdef"><b>Definition:</b> <a href="tcp__server__builder_8cc_source.html#l00235">tcp_server_builder.cc:235</a></div></div>
<div class="ttc" id="anamespaceunilink_html_a14c0a21a3c09f578b71455e31cf47956"><div class="ttname"><a href="namespaceunilink.html#a14c0a21a3c09f578b71455e31cf47956">unilink::tcp_server</a></div><div class="ttdeci">builder::TcpServerBuilder tcp_server(uint16_t port)</div><div class="ttdoc">Create a TCP server builder.</div><div class="ttdef"><b>Definition:</b> <a href="unilink_8hpp_source.html#l00087">unilink.hpp:87</a></div></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md409"></a>
Running Custom Tests</h2>
<div class="fragment"><div class="line"># Add your test file to test/CMakeLists.txt</div>
<div class="line"> </div>
<div class="line"># Build</div>
<div class="line">cmake --build build</div>
<div class="line"> </div>
<div class="line"># Run</div>
<div class="line">./build/test/my_custom_test</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md411"></a>
Test Configuration</h1>
<h2><a class="anchor" id="autotoc_md412"></a>
CTest Configuration</h2>
<p>Edit <code>CTestTestfile.cmake</code> or use command-line options:</p>
<div class="fragment"><div class="line"># Timeout for long-running tests</div>
<div class="line">ctest --timeout 300</div>
<div class="line"> </div>
<div class="line"># Repeat tests to catch flaky behavior</div>
<div class="line">ctest --repeat until-fail:100</div>
<div class="line"> </div>
<div class="line"># Run only tests matching pattern</div>
<div class="line">ctest -R &quot;TcpClient.*&quot;</div>
<div class="line"> </div>
<div class="line"># Exclude tests matching pattern</div>
<div class="line">ctest -E &quot;Stress.*&quot;</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md414"></a>
Environment Variables</h2>
<p>Control test behavior:</p>
<div class="fragment"><div class="line"># Increase log verbosity</div>
<div class="line">export UNILINK_LOG_LEVEL=DEBUG</div>
<div class="line"> </div>
<div class="line"># Disable colored output</div>
<div class="line">export GTEST_COLOR=no</div>
<div class="line"> </div>
<div class="line"># Run specific tests</div>
<div class="line">export GTEST_FILTER=TcpClientTest.*</div>
<div class="line"> </div>
<div class="line"># Run tests</div>
<div class="line">ctest</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md416"></a>
Troubleshooting Tests</h1>
<h2><a class="anchor" id="autotoc_md417"></a>
Test Failures</h2>
<p>If tests fail:</p>
<ol type="1">
<li><b>Check test output:</b> <div class="fragment"><div class="line">ctest --output-on-failure --verbose</div>
</div><!-- fragment --></li>
<li><b>Run specific failing test:</b> <div class="fragment"><div class="line">./build/test/run_core_tests --gtest_filter=FailingTest</div>
</div><!-- fragment --></li>
<li><b>Check for resource issues:</b><ul>
<li>Port conflicts (another service using test ports)</li>
<li>Insufficient permissions</li>
<li>Network connectivity</li>
</ul>
</li>
</ol>
<hr  />
<h2><a class="anchor" id="autotoc_md419"></a>
Port Conflicts</h2>
<div class="fragment"><div class="line"># Check if port is in use</div>
<div class="line">sudo lsof -i :8080</div>
<div class="line"> </div>
<div class="line"># Kill process using port</div>
<div class="line">sudo kill -9 &lt;PID&gt;</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md421"></a>
Memory Issues</h2>
<div class="fragment"><div class="line"># Run with Valgrind for detailed analysis</div>
<div class="line">valgrind --leak-check=full ./build/test/run_memory_safety_tests</div>
<div class="line"> </div>
<div class="line"># Or use AddressSanitizer</div>
<div class="line">cmake -S . -B build -DUNILINK_ENABLE_SANITIZERS=ON</div>
<div class="line">cmake --build build</div>
<div class="line">./build/test/run_memory_safety_tests</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md423"></a>
Performance Regression Testing</h1>
<h2><a class="anchor" id="autotoc_md424"></a>
Benchmark Baseline</h2>
<p>Establish performance baseline:</p>
<div class="fragment"><div class="line">./build/test/run_performance_tests &gt; baseline.txt</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md425"></a>
Compare Against Baseline</h2>
<div class="fragment"><div class="line">./build/test/run_performance_tests &gt; current.txt</div>
<div class="line">diff baseline.txt current.txt</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md426"></a>
Automated Regression Detection</h2>
<p>CI/CD automatically detects performance regressions &gt; 10%.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md428"></a>
Code Coverage</h1>
<h2><a class="anchor" id="autotoc_md429"></a>
Generate Coverage Report</h2>
<div class="fragment"><div class="line"># Build with coverage flags</div>
<div class="line">cmake -S . -B build \</div>
<div class="line">  -DCMAKE_BUILD_TYPE=Debug \</div>
<div class="line">  -DCMAKE_CXX_FLAGS=&quot;--coverage&quot; \</div>
<div class="line">  -DUNILINK_BUILD_TESTS=ON</div>
<div class="line"> </div>
<div class="line">cmake --build build -j</div>
<div class="line"> </div>
<div class="line"># Run tests</div>
<div class="line">cd build</div>
<div class="line">ctest</div>
<div class="line"> </div>
<div class="line"># Generate coverage report</div>
<div class="line">lcov --capture --directory . --output-file coverage.info</div>
<div class="line">lcov --remove coverage.info &#39;/usr/*&#39; --output-file coverage.info</div>
<div class="line">lcov --list coverage.info</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md430"></a>
View HTML Coverage Report</h2>
<div class="fragment"><div class="line"># Generate HTML report</div>
<div class="line">genhtml coverage.info --output-directory coverage_html</div>
<div class="line"> </div>
<div class="line"># Open in browser</div>
<div class="line">xdg-open coverage_html/index.html</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md432"></a>
Next Steps</h1>
<ul>
<li><a class="el" href="performance_8md.html">Performance Optimization</a> - Optimize your tests</li>
<li><a class="el" href="md_docs_guides_core_best_practices.html">Best Practices</a> - Testing best practices</li>
<li><a class="el" href="build__guide_8md.html">Build Guide</a> - Build options for testing</li>
<li><a class="el" href="md_docs_guides_core_troubleshooting.html">Troubleshooting</a> - Common test issues </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Feb 6 2026 21:58:14 for unilink by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
